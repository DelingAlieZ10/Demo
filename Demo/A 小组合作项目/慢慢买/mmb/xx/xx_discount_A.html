<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./css/xx_discount_A.css">
    <link rel="stylesheet" href="../lib/Font-Awesome-3.2.1/css/font-awesome.min.css">
    <title>Document</title>
</head>
<script>
    var width = window.screen.width;
    document.querySelector("html").style.fontSize = width / 10 + "px";
</script>

<body>
    <!--    顶部 区域  -->
    <div class="xx-header">
        <div class="header-left">
            <a href="../index.html" class="icon-angle-left"></a>
        </div>
        <h4>国内折扣</h4>
        <div class="header-right">
            <a href="javascript:void(0)"></a>
        </div>
    </div>
    <!--   内容 区域 -->
    <div>
        <div class="xx-friend">
            <ul class="fried-ul">
                <li class="border-img">
                    <a href="zhekou.aspx?id=1563982" title="立体自粘墙贴纸 70*77cm 9.8元包邮（需用券）">
                        <div class="img">
                            <img src="http://wnzk-img.zuyushop.com/r_img/img/20170703/19/f0aa60307fba47b3a6cd508634b5aa6e.jpg"></div>
                        <div class="title">立体自粘墙贴纸 70*77cm</div>
                        <div class="subtit">9.8元包邮（需用券）</div>
                        <div class="info">
                            <div class="mall">天猫商城 | 2017/7/3 19:58</div>
                        </div>
                    </a>
                </li>

            </ul>
        </div>
    </div>
    <!--   底部 通用 样式-->
    <div class="xx_nav">
        <div class="nav">
            <a href="javascript:void(0)">首页 &nbsp;&gt;&nbsp;</a><a href="javascript:void(0)">超值推荐 &nbsp;&gt;&nbsp;</a>亚马逊海外购 Swaro...
        </div>
    </div>
    <!--  广告  -->
    <div class="xx_ad">
        <div class="xx_man">
            <img src="./image/man_logo.png" alt="">
        </div>
        <div class="xx_right clearfix">
            <h3>慢慢买APP</h3>
            <div class="xx_open">
                <a href="javascript:void(0)">立即打开</a>
            </div>
            <p>专注全网比价,每一次购买都在为你省钱!</p>
        </div>
    </div>
    <div class="xx_foor">
        <div class="foor_top">
            <a href="../login/login.html">登录</a>
            <a href="../login/regester.html">注册</a>
            <a href="javascript:void(0)">返回顶部</a>
        </div>
        <p class="foor_bottom_A"><a href="javascript:void(0)" class="xx_download">手机APP下载</a> <a href="javascript:void(0)">慢慢买手机版</a> -- 掌上比价平台 </p>
        <p class="foor_bottom_B"><a href="javascript:void(0)">m.manmanbuy.com</a></p>
    </div>
</body>

</html>
<script src="../lib/jQuery/jquery-1.12.4.js"></script>
<script src="../lib/template-web.js/template-web.js"></script>
<script type="text/html" id="template">
    {{each result}}
    <li class="border-img">
        <a href="./xx_discount_B.html?productId={{$value.productId}}" title="立体自粘墙贴纸 70*77cm 9.8元包邮（需用券）">
            <div class="img">
                {{#$value.productImg}}
            </div>
            <div class="title">{{$value.productName}}</div>
            <div class="subtit">{{$value.productPrice}}</div>
            <div class="info">
                <div class="mall">{{$value.productFrom}} | {{$value.productTime}}</div>
            </div>
        </a>
    </li>
    {{/each}}
</script>
<script>
    $(function() {
        var flag = true;
        var top;
        var scrollH;
        var pageY = window.innerHeight;
        getData();




        $(window).scroll(function() {
            scrollH = document.body.scrollTop || document.documentElement.scrollTop;
            if (top < pageY + scrollH) {
                getData();
                flag = false;
            }
        })

        function getData() {
            if (!flag == true) {
                return;
            }
            $.ajax({
                url: "http://139.199.192.48:9090/api/getinlanddiscount?",
                success: function(data) {
                    console.log(data);
                    var result = template("template", data);
                    $(".fried-ul").append(result);
                    top = $(".fried-ul li").last().offset().top;
                    console.log(top);
                    flag = true;
                }
            })
        }
    })
</script>